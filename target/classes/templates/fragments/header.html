<header class="header"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
		<div class="container collapse navbar-collapse">

			<ul class="navbar-nav ms-auto">
				<li class="nav-item">
					<a class="nav-link" href="/">HOME</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/games">GAMES</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/publishers">PUBLISHERS</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/categories">CATEGORIES</a>
				</li>

				<li class="nav-item" sec:authorize="hasRole('ADMIN')">
					<a class="nav-link" href="/users">USERS</a>
				</li>

				<li class="nav-item" sec:authorize="hasRole('ADMIN')">
					<a class="nav-link" href="/records">RECORDS</a>
				</li>
			</ul>

			<div class="user-tools">

				<!-- Notifications -->
				<div class="dropdown" sec:authorize="isAuthenticated()">
					<button class="btn btn-secondary" type="button"
						data-toggle="dropdown">
						<i class="fa-solid fa-bell"></i>
					</button>

					<div th:if="${!#lists.isEmpty(unreadNotifications)}"
						th:text="${unreadNotifications.size()}"
						class="number-notifications"></div>

					<div class="dropdown-menu">
						<div class="text-right">
							<a th:href="@{/notifications/markAllRead}" class="btn btn-link">Mark
								All as Read</a>
						</div>

						<div th:each="notification : ${unreadNotifications}"
							class="dropdown-item">
							<form
								th:action="@{/notifications/markAsRead/{id}(id=${notification.id})}"
								method="post">
								<button type="submit" class="btn">
									<img th:src="${notification.image}" class="notification-image">
									<div class="notification-content">
										<p th:text="${notification.message}" class="notification-message"></p>
										<span
											th:text="${#dates.format(notification.createdAt,'dd/MM/yyyy HH:mm')}" 
											class="notification-date">
										</span>
									</div>
								</button>
							</form>
						</div>

						<p th:if="${#lists.isEmpty(unreadNotifications)}"
							class="no-notifications">No New Notifications</p>

						<a th:href="@{/notifications}" class="btn btn-link d-block">
							View All Notifications </a>
					</div>
				</div>

				<!-- User -->
				<div class="dropdown" sec:authorize="isAuthenticated()">
					<button class="btn btn-link acc-btn dropdown-toggle" type="button"
						id="userDropdown" data-toggle="dropdown">
						<span th:text="${#authentication.name}">Username</span>
					</button>
					<div class="dropdown-menu dropdown-menu-right small-dropdown"
						aria-labelledby="userDropdown">
						<a class="dropdown-item"
							th:href="@{/user/details(username=${#authentication.name})}">Profile</a>
						<form th:action="@{/logout}" method="post" style="margin: 0;">
							<button type="submit" class="dropdown-item">Logout</button>
						</form>
					</div>
				</div>

				<!-- Login -->
				<a sec:authorize="isAnonymous()" class="acc-btn" th:href="@{/login}">
					Login </a>

			</div>
		</div>
	</nav>
</header>
